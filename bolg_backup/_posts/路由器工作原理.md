---
layout: post
title: 路由器工作原理
data: 2017/5/20
subtitle: ""
description: ""
thumbnail: "/img/计网/路由器工作原理.jpeg"
tags:
  - 计算机网络#网络层
categories:
  - 计算机网络
---

# 路由器工作原理

> ## 目录

* 概述
* 输入端口
* 交换结构
* 输出端口

> ### 概述

路由器是一种具有多个输入和输出端口的专用计算机,其任务是转发分组.路由器的转发分组是网络层的主要工作之一. 下面给出典型的路由器构成图:

![](/uploads/计网/路由选择协议/路由器工作原理.png)

> ### 输入端口

![](/uploads/计网/路由选择协议/输入端口.png)

* 输入端口的线路端接功能与链路层处理实现了用于各个输入链路的物理层和链路层.
* 路由器使用转发表来查找输出端口,使得到达的分组将能经过交换结构转发到输出端口.
* 转发表是由路由器处理和更新的,但转发表的一份影子副本通常会被存放在每个输入端口, 有了影子副本,转发决策能在每个输入端口本地做出,无须调用中央路由选择处理器, 因此也避免了集中式处理的瓶颈.

> ### 交换结构

交换结构位于一台路由器的核心部位.正是通过这种交换结构,分组才能实际从一个输入端口交换到一个输出端口.交换可以由下面的三种交换技术完成.

![](/uploads/计网/路由选择协议/内存交换结构.png)
![](/uploads/计网/路由选择协议/纵横式交换结构.png)
![](/uploads/计网/路由选择协议/总线交换结构.png)

#### 内存交换结构

* 在输入端口和输出之间交换是在CPU的直接控制下完成的.
* 一个分组到达一个输入端口时, 该端口会先通过中断方式向路由选择处理器发送信号.于是,该分组从输入端口处被复制到处理器内存中.路由器选择处理器从其首部提取目的地址,在转发表中找出合适的输出端口,并将该分组复制到输出端口的缓存中.需要注意的是:不能同时发送两个分组,即使他们有不同的端口,因为经过共享系统总线一次仅能执行一次内存读/写.

#### 总线交换

* 输入端口经过一根共享总线将分组直接传送到输出端口,不需要路由选择处理器的干预.
* 当一个分组到达路由器时, 输入端口为分组预先计划一个交换机内部标签, 用于指示本地输出端口,是分组在总线上传送和传输到输出端口.该分组能由所有输出端口收到, 但只有与该标签匹配的端口才能保存该分组.
* 如果多个分组同时到达路由器,每个位于不同的输出端口,除了正在总线上传输的分组外,其他分组必须等待,因为一次只有一个分组能够跨越总线.

#### 纵横式交换结构

* 纵横式交换机是一种由2N条总线组成的互联网络.网络互联使得它能克服单一,共享式总宽带限制的缺点.
* 当某个分组到达A端口时, 需要转发到端口Y,交换机控制器闭合总线A和Y交叉部位的叉点,然后端口A在其总线上发送该分组, 该分组仅由总线Y安排接收.注意:来自端口B的一个分组在同一时间能够转发到端口X,因为A到Y和B到X的分组使用不同的输入和输出总线.然而,如果来自不同端口的两个分组其目的地为相同的输出端口,那么其中一个分组必须等待, 因为在某个时刻,总线上仅有一个分组能被传送.

> ### 输出端口

输出端口处理取出存放在输出端口内存中的分组并将其发送到输出链路上.这包括选择和取出排队的分组进行传输,执行所需的链路层和物理层传输功能.

> ## 参考资料
> 计算机网络自顶向下
> 计算机网络(谢希仁)
